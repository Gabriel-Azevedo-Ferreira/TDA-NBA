---
title: "R Notebook"
output: html_notebook
---

```{r}
library(igraph)
library(TDAmapper)
library(fastcluster)
library(FactoMineR)
library(ggplot2)

getwd()

#import data
df <- read.csv("../../Data/NBA-data-With-Positions.csv")

# labels
label <- df$PosicAbbrev
#levels(label) <- c(5,4,1,3,2)

# set index
rownames(df) <- df[,'Player']
#df <- df[,3:length(df)]

#features -> new smaller dataset -> distance matrix
chosen_features = c('REB','AST','TOV','STL','BLK','PF','PTS')
X <- as.matrix(df[chosen_features])
normX <- t(t(X)/sqrt(diag(var(X))))
d <- dist(normX,method = "euclidian")

#Taking filter function from PCA
myPCA <- PCA(X,graph = F)
plot.PCA(myPCA,axes = c(1,2),choix = "var")
plot.PCA(myPCA,axes = c(1,2),choix = "ind", col.ind = label, label = "ind.sup")

filter <- list(matrix(myPCA$ind$coord[,1]),matrix(myPCA$ind$coord[,2]))
#mapper
map    <- mapper2D(
          distance_matrix = d,
          filter_values = filter,
          num_intervals = c(30,30),#num_intervals = c(20,20), 
                                  # 20 pra low resulution e 30 pra high, teoricamente
          percent_overlap = 50,
          num_bins_when_clustering = 1
      )

#plot
g <- graph.adjacency(map$adjacency, mode="undirected")
plot(g, layout = layout.auto(g))


########
m <- matrix(c(1,2,3,4,5,6,7,8),nrow = 2)
t(t(m)/c(2,5,10,1000))

```
